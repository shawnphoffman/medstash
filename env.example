# MedStash Environment Variables
# Copy this file to .env and adjust values as needed
# For Docker deployments, set these in docker-compose.yml or Portainer


# ============================================================================
# CORS Configuration
# ============================================================================

# Allowed origins for CORS (comma-separated)
# If not set, all origins are allowed (useful for local/internal deployments)
# Example: http://localhost:3010,http://192.168.1.100:3020
# For production, consider restricting to your frontend URL(s)
ALLOWED_ORIGINS=

# ============================================================================
# Storage Configuration
# ============================================================================

# Temporary upload directory
# - Development: /tmp/medstash-uploads (default)
# - Production: /data/uploads (default, persistent in Docker)
# Files are uploaded here temporarily before being processed and moved to storage
# Should be writable and have sufficient space
UPLOAD_DIR=/tmp/medstash-uploads

# Note: Database and receipts are stored in /data by default
# In Docker, mount your volume to /data

# ============================================================================
# Logging Configuration
# ============================================================================

# Log level: ERROR, WARN, or DEBUG (default: DEBUG)
# - ERROR: Only error messages
# - WARN: Error and warning messages
# - DEBUG: All messages (errors, warnings, and debug info)
LOG_LEVEL=DEBUG

# ============================================================================
# Watch Folder Configuration
# ============================================================================

# Watch folder path for auto-import (default: /data/watch)
# Files placed in this folder will be automatically imported as receipts
# - Root-level files: Each file becomes one receipt
# - Subdirectories: All files in a directory become one receipt
# - Processed files are moved to {WATCH_FOLDER}/processed/
# - Unsupported file types are ignored
WATCH_FOLDER=/data/watch

# Watch interval: How often to scan the watch folder in minutes (default: 30)
# The service will scan the watch folder at this interval and import any new files
WATCH_INTERVAL=30

# ============================================================================
# Image Optimization Configuration (Receipt-Optimized)
# ============================================================================

# Default JPEG quality (0-100, default: 75)
# Higher values = better quality but larger files
# 75 is recommended for receipts (text legible, good compression)
IMAGE_QUALITY=75

# Maximum image dimension in pixels (default: 2000)
# Images larger than this (width or height) will be resized maintaining aspect ratio
IMAGE_MAX_DIMENSION=2000

# Preserve EXIF/ICC metadata (default: true)
# Preserves orientation and color profiles
IMAGE_PRESERVE_METADATA=true

# Use progressive JPEG encoding (default: true)
# Better compression and perceived loading for receipts
IMAGE_USE_PROGRESSIVE_JPEG=true

# Minimum file size to optimize in bytes (default: 200000 = 200KB)
# Files smaller than this may be skipped to avoid unnecessary processing
IMAGE_MIN_SIZE_TO_OPTIMIZE=200000

# Auto-detect and convert B&W images to grayscale (default: true)
# Converts black and white receipts to grayscale for 30-50% size reduction
IMAGE_AUTO_GRAYSCALE=true

# Color variance threshold for grayscale detection (0-1, default: 0.1)
# Lower values = more aggressive grayscale conversion
# Images with color variance below this threshold will be converted to grayscale
IMAGE_GRAYSCALE_THRESHOLD=0.1

# ============================================================================
# Docker Deployment Example
# ============================================================================
# When deploying with Docker/Portainer, set these as environment variables:
#
# environment:
#   - ALLOWED_ORIGINS=http://your-ip:3020
#
# volumes:
#   - /ssd/docker/medstash-test:/data
