services:
  medstash:
    # Image from GitHub Container Registry
    # Defaults to :latest, but can be overridden with MEDSTASH_IMAGE_TAG env var
    # Examples:
    #   - ghcr.io/shawnphoffman/medstash:latest
    #   - ghcr.io/shawnphoffman/medstash:v0.0.6 (version tag with v prefix)
    #   - ghcr.io/shawnphoffman/medstash:0.0.6 (version tag without v prefix)
    #   - ghcr.io/shawnphoffman/medstash:main-abc1234
    image: ghcr.io/shawnphoffman/medstash:${MEDSTASH_IMAGE_TAG:-latest}
    restart: unless-stopped
    ports:
      - ${MEDSTASH_PORT:-3020}:3000
    volumes:
      - ${MEDSTASH_DATA_DIR:-./data}:/data
    environment:
      # CORS: Optional - Set this to restrict allowed origins (comma-separated)
      # Example: - ALLOWED_ORIGINS=http://your-ip:3020,http://medstash.local
      # If not set, all origins will be allowed
      - ALLOWED_ORIGINS=${ALLOWED_ORIGINS:-}
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:3000/health"]
      interval: 60s
      timeout: 10s
      retries: 3
      start_period: 60s
